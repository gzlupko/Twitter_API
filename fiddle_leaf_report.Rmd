---
title: "fiddle_leaf_report"
author: "Gian Zlupko"
date: "4/1/2021"
output: html_document
---

```{r setup, include=FALSE, echo = FALSE}
library(ROAuth) 
library(twitteR) 
library(dplyr) 
library(igraph) 
library(visNetwork) 

api_key <- "7KhDdJQseh65sfG5dN4A6Nlve"

api_secret <- "MKyYAyDyIDdDXZQLNXz6sPpyrxWFqqeOXIpXqrTzxfUIzv0ILs" 

access_token <- "363179894-yJNsEk5RErQLKDw5SdzF1jK94phSHwJirzziZUi8"

access_token_secret <- "avP6VT9yMEmW2lYYF04hybVl61sjHpUztCX3cuBb3wk6a"

setup_twitter_oauth(api_key, api_secret, access_token, access_token_secret) 
```




## Download Tweets 

Searching Twitter for the keyword, 'monstera', referring to the monstera houseplant. Monsteras are exploding in popularity today. After mining the monstera data from Twitter, I format it for SNA analysis. I want to use SNA to explore whether a community of houseplant owners is well-connected on Twitter. To do so, I will look at social network structural features.


```{r}
library(ROAuth)
library(twitteR)

TL <- searchTwitter("monstera", n = 800, since='2020-03-30', until='2021-03-30', lang = "en")

TL <- do.call("rbind", lapply(TL, as.data.frame))

```


Prepare for SNA


```{r}

# create node and edge list  


node_list <- TL %>%
  select(screenName) %>%
  na.omit() %>%
  distinct() 


#write.csv(node_list, "node_list_twitter.csv") 



# create graph object 

edge_list <- TL %>%
  select(screenName, replyToSN) %>%
  na.omit() %>%
  rename(From = screenName, To = replyToSN) 

#write.csv(edge_list, "edge_list_twitter.csv") 

library(readr) 
new_edge <- read.csv("edge_list_twitter.csv") 
new_node <- read_csv("node_list_twitter.csv", col_names = FALSE)  



new_node$account_id <- paste(1:length(new_node)) 
head(new_node) 


edge_mat <- as.matrix(new_edge) 
nodes_mat <- as.matrix(new_node) 

monstera <- graph_from_data_frame(d = edge_mat, vertices = nodes_mat, directed = TRUE)

plot(monstera, vertex.label = NA,
     vertex.size = 5, mode = "undirected", remove.loops = T)

monstera <- simplify(monstera, remove.multiple = F, remove.loops = T)
plot(monstera, edge.arrow.size = 0.1, vertex.label = NA, vertex.size = 4, layout = layout_nicely(monstera), edge.color = 'black', directed = T)      

```


Network structural properties 


```{r}

# Average path length, indicating number of reply tweets 
mean_distance(monstera, directed = T) 


# identify largest clique 
largest_cliques(monstera) 

# plot largest clique; who is in this clique? 

monstera_clique <- largest_cliques(monstera) 

mc_1 <- as.undirected(subgraph(monstera, monstera_clique[[1]]))


plot(mc_1,
     vertex.label.color = "black",
     vertex.label.cex = 0.9,
     vertex.size = 4,
     edge.color = 'gray28',
     main = "Monstera Clique 1")



```







Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
